<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="maisonMapper">
<!-- 회원가입 -->
	<insert id="userInsert">
		INSERT INTO MAISON_USER (SEQ, ID, PWD, NAME, PHONE, ADDRESS, EMAIL) 
			VALUES (USER_SEQ.NEXTVAL, #{id}, #{pwd}, #{name}, #{phone}, #{address}, #{email}) 
	</insert>
<!-- 사진업로드 -->	
	<insert id="uploadInsert">
		INSERT INTO MAISON_CONTENT (SEQ, TITLE, CONTENT, DT, FILE_PATH, C_FLAG) 
			VALUES ((select max(seq) from maison_content)+1, #{title}, #{content}, SYSDATE, #{file_path}, #{c_flag}) 
	</insert>
<!-- 다이어리리스트 날짜목록 -->	
	<select id="date_list" resultType="MaisonContentVO">
	<![CDATA[
        SELECT TO_CHAR(TO_DATE(DECODE(#{baseDate}, 'TODAY', TO_CHAR(SYSDATE, 'YYYY-MM-DD'), #{baseDate}))-2, 'MM-DD') DATE1
		     , TO_CHAR(TO_DATE(DECODE(#{baseDate}, 'TODAY', TO_CHAR(SYSDATE, 'YYYY-MM-DD'), #{baseDate}))-1, 'MM-DD') DATE2
		     , TO_CHAR(TO_DATE(DECODE(#{baseDate}, 'TODAY', TO_CHAR(SYSDATE, 'YYYY-MM-DD'), #{baseDate}))+0, 'MM-DD') DATE3
		     , TO_CHAR(TO_DATE(DECODE(#{baseDate}, 'TODAY', TO_CHAR(SYSDATE, 'YYYY-MM-DD'), #{baseDate}))+1, 'MM-DD') DATE4
		     , TO_CHAR(TO_DATE(DECODE(#{baseDate}, 'TODAY', TO_CHAR(SYSDATE, 'YYYY-MM-DD'), #{baseDate}))+2, 'MM-DD') DATE5
  		   FROM DUAL
    ]]>
	</select>
<!-- 사진첩목록보기(자료실) -->	
	<select id="list" resultType="MaisonContentVO">
		SELECT TITLE, CONTENT, DT, FILE_PATH 
		FROM MAISON_CONTENT
		WHERE C_FLAG='U'
		ORDER BY DT DESC
	</select>
<!--  로그인 --> 
	<select id="login" resultType="MaisonUserVO">
		SELECT * 
		FROM MAISON_USER
		WHERE ID = #{id} AND PWD = #{pwd}
	</select>
<!-- 회원정보수정페이지출력 -->
	<select id="user_master" resultType="MaisonUserVO">
		SELECT * 
		FROM MAISON_USER
		WHERE ID = #{id}
	</select>
<!-- 회원탈퇴 -->
	<delete id="user_delete">
		DELETE 
		FROM MAISON_USER
		WHERE SEQ = #{seq}
	</delete>
<!-- 회원정보수정완료 -->
	<update id="user_edit">
		UPDATE MAISON_USER 
		SET PWD=#{pwd}, NAME=#{name}, PHONE=#{phone}, ADDRESS=#{address}, EMAIL=#{email} 
		WHERE SEQ=#{seq}
	</update>
</mapper>